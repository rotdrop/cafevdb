CREATE TABLE ChangeLog (id INT AUTO_INCREMENT NOT NULL, updated DATETIME(6) NOT NULL COMMENT '(DC2Type:datetime_immutable)', user VARCHAR(255) DEFAULT NULL, host VARCHAR(255) DEFAULT NULL, operation VARCHAR(255) DEFAULT NULL, tab VARCHAR(255) DEFAULT NULL, rowkey VARCHAR(255) DEFAULT NULL, col VARCHAR(255) DEFAULT NULL, oldval BLOB DEFAULT NULL, newval BLOB DEFAULT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE CompositePayments (id INT AUTO_INCREMENT NOT NULL, sepa_transaction_id INT DEFAULT NULL, musician_id INT NOT NULL, bank_account_sequence INT DEFAULT NULL, debit_mandate_sequence INT DEFAULT NULL, amount NUMERIC(7, 2) DEFAULT '0.00' NOT NULL, date_of_receipt DATE DEFAULT NULL COMMENT '(DC2Type:date_immutable)', subject VARCHAR(1024) NOT NULL, notification_message_id VARCHAR(512) DEFAULT NULL, created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_65D9920CD5560045 (sepa_transaction_id), INDEX IDX_65D9920C9523AA8A2301E184 (musician_id, bank_account_sequence), INDEX IDX_65D9920C9523AA8A544C02F9 (musician_id, debit_mandate_sequence), INDEX IDX_65D9920C9523AA8A (musician_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE EmailAttachments (file_name VARCHAR(512) NOT NULL, draft_id INT DEFAULT NULL, user VARCHAR(512) NOT NULL, INDEX IDX_199F0CDBE2F3C5D1 (draft_id), PRIMARY KEY(file_name)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE EmailDrafts (id INT AUTO_INCREMENT NOT NULL, subject VARCHAR(256) NOT NULL, data LONGTEXT NOT NULL COMMENT 'Message Data Without Attachments(DC2Type:json)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', created_by VARCHAR(255) DEFAULT NULL, updated_by VARCHAR(255) DEFAULT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE EmailTemplates (id INT AUTO_INCREMENT NOT NULL, tag VARCHAR(128) NOT NULL, subject VARCHAR(1024) NOT NULL, contents LONGTEXT DEFAULT NULL, created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', created_by VARCHAR(255) DEFAULT NULL, updated_by VARCHAR(255) DEFAULT NULL, UNIQUE INDEX UNIQ_51BDDDC389B783 (tag), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE Files (id INT AUTO_INCREMENT NOT NULL, file_name VARCHAR(512) DEFAULT NULL, mime_type VARCHAR(128) NOT NULL, size INT DEFAULT -1 NOT NULL, data_hash CHAR(32) DEFAULT NULL, updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', type enum('generic','image','encrypted') NOT NULL COMMENT 'enum(generic,image,encrypted)(DC2Type:EnumFileType)', width INT DEFAULT -1, height INT DEFAULT -1, INDEX IDX_C7F46F5DD7DF1668 (file_name), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE FileData (file_id INT NOT NULL, data_hash CHAR(32) NOT NULL, data LONGBLOB NOT NULL, transformation enum('identity','encrypted','base64') NOT NULL COMMENT 'enum(identity,encrypted,base64)(DC2Type:EnumDataTransformation)', PRIMARY KEY(file_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE GeoContinents (code VARCHAR(2) NOT NULL COLLATE `ascii_general_ci`, target VARCHAR(2) NOT NULL COLLATE `ascii_general_ci`, translation VARCHAR(1024) NOT NULL, PRIMARY KEY(code, target)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE GeoCountries (iso CHAR(2) NOT NULL COLLATE `ascii_general_ci`, target CHAR(2) NOT NULL COLLATE `ascii_general_ci`, data VARCHAR(1024) NOT NULL, PRIMARY KEY(iso, target)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE GeoPostalCodes (id INT AUTO_INCREMENT NOT NULL, country CHAR(2) NOT NULL COLLATE `ascii_general_ci`, postal_code VARCHAR(32) NOT NULL, name VARCHAR(650) NOT NULL, latitude DOUBLE PRECISION NOT NULL, longitude DOUBLE PRECISION NOT NULL, created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', UNIQUE INDEX UNIQ_B50ACD455373C966EA98E3765E237E06 (country, postal_code, name), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE GeoPostalCodeTranslations (target CHAR(2) NOT NULL COLLATE `ascii_general_ci`, geo_postal_code_id INT NOT NULL, translation VARCHAR(1024) NOT NULL, INDEX IDX_BC664719E70E684F (geo_postal_code_id), PRIMARY KEY(geo_postal_code_id, target)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE Instruments (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(128) NOT NULL, sort_order SMALLINT NOT NULL COMMENT 'Orchestral Ordering', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE instrument_instrument_family (instrument_id INT NOT NULL, instrument_family_id INT NOT NULL, INDEX IDX_2C15852ACF11D9C (instrument_id), INDEX IDX_2C15852AB4F8CF5C (instrument_family_id), PRIMARY KEY(instrument_id, instrument_family_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE InstrumentFamilies (id INT AUTO_INCREMENT NOT NULL, family VARCHAR(255) NOT NULL, deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', UNIQUE INDEX UNIQ_31147B76A5E6215B (family), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE InstrumentInsurances (id INT AUTO_INCREMENT NOT NULL, geographical_scope enum('Germany','Europe','World') DEFAULT 'Germany' NOT NULL COMMENT 'enum(Germany,Europe,World)(DC2Type:EnumGeographicalScope)', instrument_holder_id INT NOT NULL, bill_to_party_id INT NOT NULL, broker_id VARCHAR(40) NOT NULL, object VARCHAR(128) NOT NULL, accessory TINYINT(1) DEFAULT '0', manufacturer VARCHAR(128) NOT NULL, year_of_construction VARCHAR(64) NOT NULL, insurance_amount INT NOT NULL, start_of_insurance DATE NOT NULL COMMENT '(DC2Type:date_immutable)', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_B9BA7EFA948FBE6 (instrument_holder_id), INDEX IDX_B9BA7EF9D7A36FA (bill_to_party_id), INDEX IDX_B9BA7EF6CC064FC (broker_id), INDEX IDX_B9BA7EF6CC064FCBD069886 (broker_id, geographical_scope), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE InsuranceBrokers (short_name VARCHAR(40) NOT NULL, long_name VARCHAR(512) NOT NULL, address VARCHAR(512) NOT NULL, PRIMARY KEY(short_name)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE InsuranceRates (geographical_scope enum('Germany','Europe','World') DEFAULT 'Germany' NOT NULL COMMENT 'enum(Germany,Europe,World)(DC2Type:EnumGeographicalScope)', broker_id VARCHAR(40) NOT NULL, rate DOUBLE PRECISION NOT NULL COMMENT 'fraction, not percentage, excluding taxes', due_date DATE NOT NULL COMMENT 'start of the yearly insurance period(DC2Type:date_immutable)', policy_number VARCHAR(255) DEFAULT NULL, INDEX IDX_CB75C3526CC064FC (broker_id), PRIMARY KEY(broker_id, geographical_scope)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ExtLogEntries (id INT AUTO_INCREMENT NOT NULL, object_id VARCHAR(573) DEFAULT NULL, remote_address VARCHAR(45) DEFAULT NULL, action VARCHAR(8) NOT NULL, logged_at DATETIME(6) NOT NULL, object_class VARCHAR(191) NOT NULL, version INT NOT NULL, data LONGTEXT DEFAULT NULL COMMENT '(DC2Type:array)', username VARCHAR(191) DEFAULT NULL, INDEX log_class_lookup_idx (object_class), INDEX log_date_lookup_idx (logged_at), INDEX log_user_lookup_idx (username), INDEX log_version_lookup_idx (object_id, object_class, version), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB ROW_FORMAT = DYNAMIC;
CREATE TABLE Musicians (id INT AUTO_INCREMENT NOT NULL, sur_name VARCHAR(128) NOT NULL, first_name VARCHAR(128) NOT NULL, nick_name VARCHAR(128) DEFAULT NULL, display_name VARCHAR(256) DEFAULT NULL, user_id_slug VARCHAR(256) DEFAULT NULL COLLATE `ascii_bin`, user_passphrase VARCHAR(256) DEFAULT NULL COLLATE `ascii_bin`, city VARCHAR(128) DEFAULT NULL, street VARCHAR(128) DEFAULT NULL, country CHAR(2) DEFAULT NULL COLLATE `ascii_general_ci`, postal_code VARCHAR(32) DEFAULT NULL COLLATE `ascii_general_ci`, language CHAR(2) DEFAULT NULL COLLATE `ascii_general_ci`, mobile_phone VARCHAR(128) DEFAULT NULL, fixed_line_phone VARCHAR(128) DEFAULT NULL, birthday DATE DEFAULT NULL COMMENT '(DC2Type:date_immutable)', email VARCHAR(256) NOT NULL, member_status enum('regular','passive','soloist','conductor','temporary') DEFAULT 'regular' NOT NULL COMMENT 'passive, soloist, conductor and temporary are excluded from mass-email. soloist and conductor are even excluded from "per-project" email unless explicitly selected. enum(regular,passive,soloist,conductor,temporary)(DC2Type:EnumMemberStatus)', remarks VARCHAR(1024) DEFAULT NULL, updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', uuid BINARY(16) NOT NULL COMMENT '(DC2Type:uuid_binary)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', UNIQUE INDEX UNIQ_3CC489824BB0996A (user_id_slug), UNIQUE INDEX UNIQ_3CC48982D17F50A6 (uuid), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE MusicianInstruments (musician_id INT NOT NULL, instrument_id INT NOT NULL, ranking INT DEFAULT 1 NOT NULL COMMENT 'Ranking of the instrument w.r.t. to the given musician (lower is better)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_332855779523AA8A (musician_id), INDEX IDX_33285577CF11D9C (instrument_id), PRIMARY KEY(musician_id, instrument_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB COMMENT = 'Join-table Musicians -> Instruments' ;
CREATE TABLE MusicianPhoto (id INT AUTO_INCREMENT NOT NULL, owner_id INT NOT NULL, image_id INT NOT NULL, updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', UNIQUE INDEX UNIQ_A52F29707E3C61F9 (owner_id), UNIQUE INDEX UNIQ_A52F29703DA5256D (image_id), UNIQUE INDEX UNIQ_A52F29707E3C61F93DA5256D (owner_id, image_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE numbers (n INT NOT NULL, PRIMARY KEY(n)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectEvents (event_uri VARCHAR(764) NOT NULL, project_id INT NOT NULL, event_uid VARCHAR(764) NOT NULL, calendar_id INT NOT NULL, calendar_uri VARCHAR(764) NOT NULL, type enum('VEVENT','VTODO','VJOURNAL','VCARD') DEFAULT NULL COMMENT 'enum(VEVENT,VTODO,VJOURNAL,VCARD)(DC2Type:EnumVCalendarType)', INDEX IDX_7E38FC8B166D1F9C (project_id), UNIQUE INDEX UNIQ_7E38FC8B166D1F9C4254C3D5 (project_id, event_uid), PRIMARY KEY(project_id, event_uri)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectInstruments (voice INT DEFAULT 0 NOT NULL COMMENT 'Voice specification if applicable, set to 0 if separation by voice is not needed', project_id INT NOT NULL, musician_id INT NOT NULL, instrument_id INT NOT NULL, section_leader TINYINT(1) DEFAULT '0' NOT NULL, INDEX IDX_436762A6166D1F9C (project_id), INDEX IDX_436762A69523AA8A (musician_id), INDEX IDX_436762A6CF11D9C (instrument_id), INDEX IDX_436762A6166D1F9C9523AA8A (project_id, musician_id), INDEX IDX_436762A69523AA8ACF11D9C (musician_id, instrument_id), INDEX IDX_436762A6166D1F9CCF11D9CE7FB583B (project_id, instrument_id, voice), PRIMARY KEY(project_id, musician_id, instrument_id, voice)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectInstrumentationNumbers (voice INT DEFAULT 0 NOT NULL COMMENT 'Voice specification if applicable, set to 0 if separation by voice is not needed', project_id INT NOT NULL, instrument_id INT NOT NULL, quantity INT DEFAULT 1 NOT NULL COMMENT 'Number of required musicians for this instrument', INDEX IDX_D8939186166D1F9C (project_id), INDEX IDX_D8939186CF11D9C (instrument_id), PRIMARY KEY(project_id, instrument_id, voice)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectParticipants (project_id INT NOT NULL, musician_id INT NOT NULL, bank_account_sequence INT DEFAULT NULL, debit_mandate_sequence INT DEFAULT NULL, registration TINYINT(1) DEFAULT '0' COMMENT 'Participant has confirmed the registration.', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_D9AE987B166D1F9C (project_id), INDEX IDX_D9AE987B9523AA8A (musician_id), INDEX IDX_D9AE987B9523AA8A2301E184 (musician_id, bank_account_sequence), INDEX IDX_D9AE987B9523AA8A544C02F9 (musician_id, debit_mandate_sequence), PRIMARY KEY(project_id, musician_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectParticipantFields (id INT AUTO_INCREMENT NOT NULL, project_id INT NOT NULL, default_value BINARY(16) DEFAULT NULL COMMENT '(DC2Type:uuid_binary)', display_order INT DEFAULT NULL, name VARCHAR(128) NOT NULL, multiplicity enum('simple','single','multiple','parallel','recurring','groupofpeople','groupsofpeople') NOT NULL COMMENT 'enum(simple,single,multiple,parallel,recurring,groupofpeople,groupsofpeople)(DC2Type:EnumParticipantFieldMultiplicity)', data_type enum('text','html','boolean','integer','float','date','datetime','service-fee','cloud-file','db-file') DEFAULT 'text' NOT NULL COMMENT 'enum(text,html,boolean,integer,float,date,datetime,service-fee,cloud-file,db-file)(DC2Type:EnumParticipantFieldDataType)', due_date DATE DEFAULT NULL COMMENT 'Due-date for financial fields.(DC2Type:date_immutable)', deposit_due_date DATE DEFAULT NULL COMMENT 'Due-date of deposit for financial fields.(DC2Type:date_immutable)', tooltip VARCHAR(4096) DEFAULT NULL, tab VARCHAR(256) DEFAULT NULL COMMENT 'Tab to display the field in. If empty, then the project tab is used.', encrypted TINYINT(1) DEFAULT '0', readers VARCHAR(1024) DEFAULT NULL COMMENT 'If non-empty restrict the visbility to this comma separated list of user-groups.', writers VARCHAR(1024) DEFAULT NULL COMMENT 'Empty or comma separated list of groups allowed to change the field.', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_F6F5D9C6166D1F9C (project_id), UNIQUE INDEX defaultValue_uniq (id, default_value), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectParticipantFieldsDataOptions (field_id INT NOT NULL, `key` BINARY(16) NOT NULL COMMENT '(DC2Type:uuid_binary)', label VARCHAR(128) DEFAULT NULL, data VARCHAR(1024) DEFAULT NULL, deposit DOUBLE PRECISION DEFAULT NULL, `limit` BIGINT DEFAULT NULL, tooltip VARCHAR(4096) DEFAULT NULL, deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_FA443FE443707B0 (field_id), PRIMARY KEY(field_id, `key`)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectParticipantFieldsData (option_key BINARY(16) NOT NULL COMMENT '(DC2Type:uuid_binary)', field_id INT NOT NULL, project_id INT NOT NULL, musician_id INT NOT NULL, supporting_document_id INT DEFAULT NULL, option_value MEDIUMTEXT DEFAULT NULL, deposit DOUBLE PRECISION DEFAULT NULL, created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_E1AAA1E9443707B0 (field_id), INDEX IDX_E1AAA1E9166D1F9C (project_id), INDEX IDX_E1AAA1E99523AA8A (musician_id), INDEX IDX_E1AAA1E9443707B03CEE7BEE (field_id, option_key), INDEX IDX_E1AAA1E9166D1F9C9523AA8A (project_id, musician_id), UNIQUE INDEX UNIQ_E1AAA1E92423759C (supporting_document_id), PRIMARY KEY(field_id, project_id, musician_id, option_key)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectPayments (id INT AUTO_INCREMENT NOT NULL, field_id INT NOT NULL, project_id INT NOT NULL, musician_id INT NOT NULL, receivable_key BINARY(16) NOT NULL COMMENT '(DC2Type:uuid_binary)', composite_payment_id INT DEFAULT NULL, supporting_document_id INT DEFAULT NULL, amount NUMERIC(7, 2) DEFAULT '0.00' NOT NULL, subject VARCHAR(1024) NOT NULL, INDEX IDX_F6372AE2443707B0166D1F9C9523AA8AD151D1BF (field_id, project_id, musician_id, receivable_key), INDEX IDX_F6372AE2443707B0D151D1BF (field_id, receivable_key), INDEX IDX_F6372AE2930D2644 (composite_payment_id), INDEX IDX_F6372AE2166D1F9C (project_id), INDEX IDX_F6372AE29523AA8A (musician_id), INDEX IDX_F6372AE2166D1F9C9523AA8A (project_id, musician_id), UNIQUE INDEX UNIQ_F6372AE22423759C (supporting_document_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectWebPages (article_id INT DEFAULT -1 NOT NULL, project_id INT NOT NULL, article_name VARCHAR(128) DEFAULT '' NOT NULL, category_id INT DEFAULT -1 NOT NULL, priority INT DEFAULT -1 NOT NULL, INDEX IDX_EB77064F166D1F9C (project_id), UNIQUE INDEX UNIQ_EB77064F166D1F9C7294869C (project_id, article_id), PRIMARY KEY(project_id, article_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE SentEmails (message_id VARCHAR(256) NOT NULL COLLATE `ascii_bin`, created_by VARCHAR(255) DEFAULT NULL, bulk_recipients LONGTEXT NOT NULL, bulk_recipients_hash CHAR(32) NOT NULL COLLATE `ascii_bin`, cc LONGTEXT DEFAULT NULL, bcc LONGTEXT DEFAULT NULL, subject LONGTEXT NOT NULL, subject_hash CHAR(32) NOT NULL COLLATE `ascii_bin`, html_body LONGTEXT NOT NULL, html_body_hash CHAR(32) NOT NULL COLLATE `ascii_bin`, created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', PRIMARY KEY(message_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE SepaBankAccounts (sequence INT NOT NULL, musician_id INT NOT NULL, iban VARCHAR(256) NOT NULL COLLATE `ascii_bin`, bic VARCHAR(256) NOT NULL COLLATE `ascii_bin`, blz VARCHAR(256) NOT NULL COLLATE `ascii_bin`, bank_account_owner VARCHAR(512) NOT NULL COLLATE `ascii_bin`, deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_4F1F148B9523AA8A (musician_id), PRIMARY KEY(musician_id, sequence)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE SepaBulkTransactions (id INT AUTO_INCREMENT NOT NULL, submission_deadline DATE NOT NULL COMMENT '(DC2Type:date_immutable)', submit_date DATE DEFAULT NULL COMMENT '(DC2Type:date_immutable)', due_date DATE NOT NULL COMMENT '(DC2Type:date_immutable)', submission_event_uri VARCHAR(256) NOT NULL COMMENT 'Cloud Calendar Object URI', submission_event_uid VARCHAR(256) NOT NULL COMMENT 'Cloud Calendar Object UID', submission_task_uri VARCHAR(256) NOT NULL COMMENT 'Cloud Calendar Object URI', submission_task_uid VARCHAR(256) NOT NULL COMMENT 'Cloud Calendar Object UID', due_event_uri VARCHAR(256) NOT NULL COMMENT 'Cloud Calendar Object URI', due_event_uid VARCHAR(256) NOT NULL COMMENT 'Cloud Calendar Object UID', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', sepa_transaction enum('debit_note','bank_transfer') NOT NULL COMMENT 'enum(debit_note,bank_transfer)(DC2Type:EnumSepaTransaction)', pre_notification_deadline DATE DEFAULT NULL COMMENT '(DC2Type:date_immutable)', pre_notification_event_uri VARCHAR(256) DEFAULT NULL COMMENT 'Cloud Calendar Object URI', pre_notification_task_uri VARCHAR(256) DEFAULT NULL COMMENT 'Cloud Calendar Object URI', PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE SepaBulkTransactionData (sepa_bulk_transaction_id INT NOT NULL, encrypted_file_id INT NOT NULL, INDEX IDX_1EBA3E5BED6D4895 (sepa_bulk_transaction_id), UNIQUE INDEX UNIQ_1EBA3E5BEC15E76C (encrypted_file_id), PRIMARY KEY(sepa_bulk_transaction_id, encrypted_file_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE SepaDebitMandates (sequence INT NOT NULL, musician_id INT NOT NULL, bank_account_sequence INT NOT NULL, project_id INT NOT NULL, written_mandate_id INT DEFAULT NULL, mandate_reference VARCHAR(35) NOT NULL COLLATE `ascii_general_ci`, non_recurring TINYINT(1) NOT NULL, mandate_date DATE DEFAULT NULL COMMENT '(DC2Type:date_immutable)', pre_notification_calendar_days INT DEFAULT 14 NOT NULL, pre_notification_business_days INT DEFAULT NULL, last_used_date DATE DEFAULT NULL COMMENT '(DC2Type:date_immutable)', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_1C500299523AA8A (musician_id), INDEX IDX_1C500299523AA8A2301E184 (musician_id, bank_account_sequence), INDEX IDX_1C50029166D1F9C (project_id), UNIQUE INDEX UNIQ_1C50029D26EB11F (written_mandate_id), INDEX IDX_1C500299523AA8A2301E184166D1F9C (musician_id, bank_account_sequence, project_id), UNIQUE INDEX UNIQ_1C50029D0BE4741 (mandate_reference), UNIQUE INDEX UNIQ_1C500299523AA8A5286D72B166D1F9C (musician_id, sequence, project_id), PRIMARY KEY(musician_id, sequence)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE TableFieldTranslations (id INT AUTO_INCREMENT NOT NULL, locale VARCHAR(8) NOT NULL, object_class VARCHAR(191) NOT NULL, field VARCHAR(32) NOT NULL, foreign_key VARCHAR(64) NOT NULL, content LONGTEXT DEFAULT NULL, INDEX translations_lookup_idx (locale, object_class, foreign_key), UNIQUE INDEX lookup_unique_idx (locale, object_class, field, foreign_key), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB ROW_FORMAT = DYNAMIC;
CREATE TABLE Translations (locale CHAR(5) NOT NULL COMMENT 'Locale for translation, .e.g. en_US', translation_key_id INT NOT NULL, translation VARCHAR(1024) NOT NULL, INDEX IDX_DE86017FD07ED992 (translation_key_id), PRIMARY KEY(translation_key_id, locale)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE TranslationKeys (id INT AUTO_INCREMENT NOT NULL, phrase VARCHAR(768) NOT NULL COMMENT 'Keyword to be translated. Normally en_US, but could be any unique tag', UNIQUE INDEX UNIQ_F15EDA49A24BE60C (phrase), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE TranslationLocations (file VARCHAR(766) NOT NULL, line INT NOT NULL, translation_key_id INT NOT NULL, INDEX IDX_F23942BBD07ED992 (translation_key_id), PRIMARY KEY(translation_key_id, file, line)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE Projects (id INT AUTO_INCREMENT NOT NULL, year INT UNSIGNED NOT NULL, name VARCHAR(64) NOT NULL, type enum('temporary','permanent','template') DEFAULT 'temporary' NOT NULL COMMENT 'enum(temporary,permanent,template)(DC2Type:EnumProjectTemporalType)', created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', deleted DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', UNIQUE INDEX UNIQ_A5E5D1F25E237E06 (name), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE ProjectPosters (id INT AUTO_INCREMENT NOT NULL, owner_id INT NOT NULL, image_id INT NOT NULL, INDEX IDX_A4DE60BA7E3C61F9 (owner_id), UNIQUE INDEX UNIQ_A4DE60BA3DA5256D (image_id), UNIQUE INDEX UNIQ_A4DE60BA7E3C61F93DA5256D (owner_id, image_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
ALTER TABLE CompositePayments ADD CONSTRAINT FK_65D9920CD5560045 FOREIGN KEY (sepa_transaction_id) REFERENCES SepaBulkTransactions (id);
ALTER TABLE CompositePayments ADD CONSTRAINT FK_65D9920C9523AA8A2301E184 FOREIGN KEY (musician_id, bank_account_sequence) REFERENCES SepaBankAccounts (musician_id, sequence);
ALTER TABLE CompositePayments ADD CONSTRAINT FK_65D9920C9523AA8A544C02F9 FOREIGN KEY (musician_id, debit_mandate_sequence) REFERENCES SepaDebitMandates (musician_id, sequence);
ALTER TABLE CompositePayments ADD CONSTRAINT FK_65D9920C9523AA8A FOREIGN KEY (musician_id) REFERENCES Musicians (id);
ALTER TABLE EmailAttachments ADD CONSTRAINT FK_199F0CDBE2F3C5D1 FOREIGN KEY (draft_id) REFERENCES EmailDrafts (id) ON DELETE CASCADE;
ALTER TABLE FileData ADD CONSTRAINT FK_969FA96893CB796C FOREIGN KEY (file_id) REFERENCES Files (id);
ALTER TABLE GeoPostalCodeTranslations ADD CONSTRAINT FK_BC664719E70E684F FOREIGN KEY (geo_postal_code_id) REFERENCES GeoPostalCodes (id);
ALTER TABLE instrument_instrument_family ADD CONSTRAINT FK_2C15852ACF11D9C FOREIGN KEY (instrument_id) REFERENCES Instruments (id) ON DELETE CASCADE;
ALTER TABLE instrument_instrument_family ADD CONSTRAINT FK_2C15852AB4F8CF5C FOREIGN KEY (instrument_family_id) REFERENCES InstrumentFamilies (id) ON DELETE CASCADE;
ALTER TABLE InstrumentInsurances ADD CONSTRAINT FK_B9BA7EFA948FBE6 FOREIGN KEY (instrument_holder_id) REFERENCES Musicians (id);
ALTER TABLE InstrumentInsurances ADD CONSTRAINT FK_B9BA7EF9D7A36FA FOREIGN KEY (bill_to_party_id) REFERENCES Musicians (id);
ALTER TABLE InstrumentInsurances ADD CONSTRAINT FK_B9BA7EF6CC064FC FOREIGN KEY (broker_id) REFERENCES InsuranceBrokers (short_name);
ALTER TABLE InstrumentInsurances ADD CONSTRAINT FK_B9BA7EF6CC064FCBD069886 FOREIGN KEY (broker_id, geographical_scope) REFERENCES InsuranceRates (broker_id, geographical_scope);
ALTER TABLE InsuranceRates ADD CONSTRAINT FK_CB75C3526CC064FC FOREIGN KEY (broker_id) REFERENCES InsuranceBrokers (short_name) ON UPDATE CASCADE;
ALTER TABLE MusicianInstruments ADD CONSTRAINT FK_332855779523AA8A FOREIGN KEY (musician_id) REFERENCES Musicians (id);
ALTER TABLE MusicianInstruments ADD CONSTRAINT FK_33285577CF11D9C FOREIGN KEY (instrument_id) REFERENCES Instruments (id);
ALTER TABLE MusicianPhoto ADD CONSTRAINT FK_A52F29707E3C61F9 FOREIGN KEY (owner_id) REFERENCES Musicians (id);
ALTER TABLE MusicianPhoto ADD CONSTRAINT FK_A52F29703DA5256D FOREIGN KEY (image_id) REFERENCES Files (id);
ALTER TABLE ProjectEvents ADD CONSTRAINT FK_7E38FC8B166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE ProjectInstruments ADD CONSTRAINT FK_436762A6166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE ProjectInstruments ADD CONSTRAINT FK_436762A69523AA8A FOREIGN KEY (musician_id) REFERENCES Musicians (id);
ALTER TABLE ProjectInstruments ADD CONSTRAINT FK_436762A6CF11D9C FOREIGN KEY (instrument_id) REFERENCES Instruments (id);
ALTER TABLE ProjectInstruments ADD CONSTRAINT FK_436762A6166D1F9C9523AA8A FOREIGN KEY (project_id, musician_id) REFERENCES ProjectParticipants (project_id, musician_id) ON DELETE CASCADE;
ALTER TABLE ProjectInstruments ADD CONSTRAINT FK_436762A69523AA8ACF11D9C FOREIGN KEY (musician_id, instrument_id) REFERENCES MusicianInstruments (musician_id, instrument_id);
ALTER TABLE ProjectInstruments ADD CONSTRAINT FK_436762A6166D1F9CCF11D9CE7FB583B FOREIGN KEY (project_id, instrument_id, voice) REFERENCES ProjectInstrumentationNumbers (project_id, instrument_id, voice);
ALTER TABLE ProjectInstrumentationNumbers ADD CONSTRAINT FK_D8939186166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE ProjectInstrumentationNumbers ADD CONSTRAINT FK_D8939186CF11D9C FOREIGN KEY (instrument_id) REFERENCES Instruments (id);
ALTER TABLE ProjectParticipants ADD CONSTRAINT FK_D9AE987B166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE ProjectParticipants ADD CONSTRAINT FK_D9AE987B9523AA8A FOREIGN KEY (musician_id) REFERENCES Musicians (id);
ALTER TABLE ProjectParticipants ADD CONSTRAINT FK_D9AE987B9523AA8A2301E184 FOREIGN KEY (musician_id, bank_account_sequence) REFERENCES SepaBankAccounts (musician_id, sequence);
ALTER TABLE ProjectParticipants ADD CONSTRAINT FK_D9AE987B9523AA8A544C02F9 FOREIGN KEY (musician_id, debit_mandate_sequence) REFERENCES SepaDebitMandates (musician_id, sequence);
ALTER TABLE ProjectParticipantFields ADD CONSTRAINT FK_F6F5D9C6166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE ProjectParticipantFields ADD CONSTRAINT FK_F6F5D9C6BF396750F4510C3A FOREIGN KEY (id, default_value) REFERENCES ProjectParticipantFieldsDataOptions (field_id, `key`);
ALTER TABLE ProjectParticipantFieldsDataOptions ADD CONSTRAINT FK_FA443FE443707B0 FOREIGN KEY (field_id) REFERENCES ProjectParticipantFields (id);
ALTER TABLE ProjectParticipantFieldsData ADD CONSTRAINT FK_E1AAA1E9443707B0 FOREIGN KEY (field_id) REFERENCES ProjectParticipantFields (id);
ALTER TABLE ProjectParticipantFieldsData ADD CONSTRAINT FK_E1AAA1E9166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE ProjectParticipantFieldsData ADD CONSTRAINT FK_E1AAA1E99523AA8A FOREIGN KEY (musician_id) REFERENCES Musicians (id);
ALTER TABLE ProjectParticipantFieldsData ADD CONSTRAINT FK_E1AAA1E9443707B03CEE7BEE FOREIGN KEY (field_id, option_key) REFERENCES ProjectParticipantFieldsDataOptions (field_id, `key`);
ALTER TABLE ProjectParticipantFieldsData ADD CONSTRAINT FK_E1AAA1E9166D1F9C9523AA8A FOREIGN KEY (project_id, musician_id) REFERENCES ProjectParticipants (project_id, musician_id);
ALTER TABLE ProjectParticipantFieldsData ADD CONSTRAINT FK_E1AAA1E92423759C FOREIGN KEY (supporting_document_id) REFERENCES Files (id);
ALTER TABLE ProjectPayments ADD CONSTRAINT FK_F6372AE2443707B0166D1F9C9523AA8AD151D1BF FOREIGN KEY (field_id, project_id, musician_id, receivable_key) REFERENCES ProjectParticipantFieldsData (field_id, project_id, musician_id, option_key);
ALTER TABLE ProjectPayments ADD CONSTRAINT FK_F6372AE2443707B0D151D1BF FOREIGN KEY (field_id, receivable_key) REFERENCES ProjectParticipantFieldsDataOptions (field_id, `key`);
ALTER TABLE ProjectPayments ADD CONSTRAINT FK_F6372AE2930D2644 FOREIGN KEY (composite_payment_id) REFERENCES CompositePayments (id);
ALTER TABLE ProjectPayments ADD CONSTRAINT FK_F6372AE2166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE ProjectPayments ADD CONSTRAINT FK_F6372AE29523AA8A FOREIGN KEY (musician_id) REFERENCES Musicians (id);
ALTER TABLE ProjectPayments ADD CONSTRAINT FK_F6372AE2166D1F9C9523AA8A FOREIGN KEY (project_id, musician_id) REFERENCES ProjectParticipants (project_id, musician_id);
ALTER TABLE ProjectPayments ADD CONSTRAINT FK_F6372AE22423759C FOREIGN KEY (supporting_document_id) REFERENCES Files (id);
ALTER TABLE ProjectWebPages ADD CONSTRAINT FK_EB77064F166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE SepaBankAccounts ADD CONSTRAINT FK_4F1F148B9523AA8A FOREIGN KEY (musician_id) REFERENCES Musicians (id);
ALTER TABLE SepaBulkTransactionData ADD CONSTRAINT FK_1EBA3E5BED6D4895 FOREIGN KEY (sepa_bulk_transaction_id) REFERENCES SepaBulkTransactions (id) ON DELETE CASCADE;
ALTER TABLE SepaBulkTransactionData ADD CONSTRAINT FK_1EBA3E5BEC15E76C FOREIGN KEY (encrypted_file_id) REFERENCES Files (id);
ALTER TABLE SepaDebitMandates ADD CONSTRAINT FK_1C500299523AA8A FOREIGN KEY (musician_id) REFERENCES Musicians (id);
ALTER TABLE SepaDebitMandates ADD CONSTRAINT FK_1C500299523AA8A2301E184 FOREIGN KEY (musician_id, bank_account_sequence) REFERENCES SepaBankAccounts (musician_id, sequence);
ALTER TABLE SepaDebitMandates ADD CONSTRAINT FK_1C50029166D1F9C FOREIGN KEY (project_id) REFERENCES Projects (id);
ALTER TABLE SepaDebitMandates ADD CONSTRAINT FK_1C50029D26EB11F FOREIGN KEY (written_mandate_id) REFERENCES Files (id);
ALTER TABLE Translations ADD CONSTRAINT FK_DE86017FD07ED992 FOREIGN KEY (translation_key_id) REFERENCES TranslationKeys (id) ON DELETE CASCADE;
ALTER TABLE TranslationLocations ADD CONSTRAINT FK_F23942BBD07ED992 FOREIGN KEY (translation_key_id) REFERENCES TranslationKeys (id) ON DELETE CASCADE;
ALTER TABLE ProjectPosters ADD CONSTRAINT FK_A4DE60BA7E3C61F9 FOREIGN KEY (owner_id) REFERENCES Projects (id);
ALTER TABLE ProjectPosters ADD CONSTRAINT FK_A4DE60BA3DA5256D FOREIGN KEY (image_id) REFERENCES Files (id);
CREATE TABLE Migrations (version CHAR(14) NOT NULL COLLATE `ascii_general_ci`, created DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', updated DATETIME(6) DEFAULT NULL COMMENT '(DC2Type:datetime_immutable)', PRIMARY KEY(version)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
