/**
 * Orchestra member, musicion and project management application.
 *
 * CAFEVDB -- Camerata Academica Freiburg e.V. DataBase.
 *
 * @author Claus-Justus Heine
 * @copyright 2011-2016, 2021 Claus-Justus Heine <himself@claus-justus-heine.de>
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU GENERAL PUBLIC LICENSE
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU AFFERO GENERAL PUBLIC LICENSE for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library.  If not, see <http://www.gnu.org/licenses/>.
 */

.recipients-select {
  button {
    min-height: unset;
  }
  @import 'bootstrap/scss/bootstrap';
  @import 'bootstrap4-duallistbox/dist/bootstrap-duallistbox';
  .bootstrap-duallistbox-container {
    input, select, button {
      background-color:#FFF;
    }
  }
}

.ui-dialog.emailform {
  overflow:hidden;
  max-height: 90%; /* !important;*/
  /*max-width: 90%; *//* !important;*/

  /* dialog popup, header */

  div.ui-dialog-titlebar {
    padding-bottom:0;
    border-bottom-right-radius:0;
    border-bottom-left-radius:0;
    border-bottom:0;
  }

  #emailformdialog {

    padding:0;
    border-top-right-radius:0;
    border-top-left-radius:0;

    div#emailformwrapper {

      /************************************************************************
       *
       * General stuff, background etc.
       *
       */

      padding:0;
      background-color:#F2F8FF;

      .ui-tabs-nav {
        margin-bottom: 0;
      }

      > div {
        height:auto !important;
        overflow-y:auto;
        overflow-x:hidden;
      }

      ul#emailformtabs {
        padding-top:0;
        border-top-right-radius:0;
        border-top-left-radius:0;
        border-top:0;

        li.dropdown-container {
          &:hover {
            font-weight:bold;
            background-color: var(--color-background-hover);
          }

          &:active {
            background-color: var(--color-primary-light);
          }

          nav {
            top:30px;
          }
        }
      } /* ul#emailformtabs */

      form#cafevdb-email-form {

        fieldset.page {
          max-width:65em;
          /* padding-right:1.2em; */
        }

        /****************************************************************************
         *
         * recipients filters
         *
         */

        #emailformrecipients {
          overflow-y: auto;
          overflow-x: hidden;
          padding-bottom: 0px !important;
        }

        /****************************************************************************
         *
         * status messages
         *
         */

        #emailformdebug {
          height:auto;
          width:65em;
          max-width:65em;
          overflow:auto;
        }

        /****************************************************************************
         *
         * email composition
         *
         */

        #emailformcomposer  {
          overflow-y: auto;
          overflow-x: hidden;
          padding-bottom: 0px !important;

          fieldset.email-composition.page {
            margin-bottom:1em;
          }
        }

        /****************************************************************************/

        td.caption {
          font-weight:bold;
          vertical-align:top;
          padding-right:0.5em;
          min-width:10em;
        }

        tr.all-attachments {
          .flex-container {
            margin-bottom:3px;
          }
          button {
            background-color:#C6DEFF;
            vertical-align:middle;
            height:28px;
            width:34px;
            padding:5px;
            border-style:outset;
            margin-right: 0.5em;
            &.upload {
              img {
                width:24px;
              }
            }
            &.cloud {
              padding:5px 0;
              img {
                width:26px;
              }
            }
            &.events {
              padding:0px;
              img {
                vertical-align:top;
                height:24px;
              }
            }
            &.personal {
              img {
                width:24px;
              }
            }
            &.visibility-toggle {
              padding: 5px 0;
              img {
                width:24px;
              }
            }
          }
          .separator {
            display: inline-block;
            margin: 8px 1em 8px 0.5em;
            border-left: 1px solid black;
          }
        }

        /* attachments selectors and controls */
        tr.attachments {
          &.no-attachments {
            display:none;
          }
          &.empty-selection {
            display:none;
            &.show-selectable {
              display:table-row;
            }
          }
	  /* give show-selectable priority */
	  &.hidden.show-selectable {
            display:table-row;
          }
          td.content {
            .chosen-container {
              min-width:85%;
              max-width:85%;
              float:left;
              /* max-height:40px; */

              /* &.chosen-with-drop .chosen-drop {
                position:relative;
                top:100%;
                margin-bottom:1em;
              } */

              .chosen-drop {
                position:absolute;
                top:-99999px;
              }
            }
            .attachment-controls {
              float:right;
              display:inline-block;
              input[type=submit], input[type=button] {
                float:left;
                background-repeat:no-repeat;
                background-size: 24px 24px;
                background-position: center;
                width:27px;
                height:27px;
                font-size:0pt;
                vertical-align:middle;
                &.visibility-toggle {
                  background-image:url('../../../core/img/actions/toggle.svg');
                }
                &.delete-all-attachments {
                  background-image:url('../img/cafevdb-delete.svg');
                }
              }
            }
          }
        }

        /**************************/

        tr.submit {
          td {
            padding-top:0.5em;
            margin:0;

            .container {
              display:inline-block;
              &.send, .preview {
                float:left;
              }
              &.cancel {
                float:right;
              }
            }
          }
        }

        tr, tr:hover, tr:active {
          background-color:inherit;
        }

        td.body, td.caption {
          vertical-align:top;
        }

        tr.stored-messages td {
          border-bottom:1px solid #808080;
          padding-bottom:0.5em;
        }

        td.email-address.input input.address-book-emails,
        td.stored-messages-storage input.submit {
          background-repeat:no-repeat;
          background-size: 24px 24px;
          background-position: center;
          width:27px;
          height:27px;
          font-size:0pt;
          vertical-align:middle;
        }

        td.stored-messages-storage {
          text-align:right;

          input {
            padding-top:5px;
          }

          span.checkbox-button.#{$cssPrefix}container {
            position:relative;
            vertical-align:middle;

            span.button.save-as-template {
              background-image: url('../img/template.svg');
            }

            span.button.draft-auto-save {
              background-image: url('../img/autosave.svg');
            }

            span.button {
              background-repeat:no-repeat;
              background-position:center;
              background-size:22px 22px;
              display:inline-block;
              width:27px;
            }

            input[type=checkbox]:checked + label span.button {
              background-color:red !important;
              box-shadow:2px 2px 2px #080808 inset;
            }

            input[type="checkbox"] {
              position: absolute;
              left:-10000px;
              top: auto;
              width: 1px;
              height: 1px;
              overflow: hidden;
            }
          }

          input.save-message {
            background-image:url('../img/save.svg');
          }

          input.delete-message {
            background-image:url('../img/cafevdb-delete.svg');
          }
        } /* td.stored-messages-storage */

        td.email-address.input input.address-book-emails {
          background-image:url('../img/contacts-dark.svg');
          /*  background-color:#000;*/
          float:right;
          &.loading {
            background-image:url('../../../core/img/loading.gif');
          }
        }

        .stored-messages-choose .chosen-container {
          width:20em !important;
        }

        .chosen-container .chosen-default {
          color:#000;
          font-weight:bold;
        }

        #emailCurrentTemplate {
          width:16em;
          margin-left:1em;
          vertical-align:middle;
        }

        #emailCurrentTemplate:disabled {
          opacity:1;
        }

        td.email-recipients {
          padding-top:1em;
        }

        td.email-address.input {
          width:100%;
          /*padding: 0 1em 0 0;*/
        }
        td.email-address.input input {
          width:90%;
          float:left;
        }

        td.email-address.display {
          width:100%;
          overflow:hidden;
        }

        td.email-address.display span {
          display:inline-block;
          max-width:45em;
          overflow:hidden;
          text-overflow:ellipsis;
        }

        td.subject.input span.subject.tag {
          font-family:monospace;
          font-size:100%;
          width:auto;
          max-width:30%;
          text-align:right;
          font-weight:bold;
          display:inline-block;
          float:left;
          line-height:2.5em;
          overflow:hidden;
          text-overflow:ellipsis;
        }

        td.subject.input span.subject.input {
          width:67%;
          /* padding: 0 1em 0 0; */
          display:inline-block;
          line-height:2.5em;
          float:right;
        }

        td.subject.input input {
          width:100%;
        }

        td.messagetext {
          padding: 0.5em 0;
        }

        td input.sender-name {
          width:100%;
        }

        /*****************************************************************************
         *
         * email recipients selection
         *
         */
        div.#{$cssPrefix}row {
          width:100%;
        }

        div.#{$cssPrefix}row:after {
          content:" ";
          display:block;
          height:0;
          clear: both;
        }

        span.#{$cssPrefix}container {
          display:inline-block;
        }

        .#{$cssPrefix}container.left {
          float:left;
        }

        .#{$cssPrefix}container.right {
          float:right;
          text-align:right;
        }

        .label {
          font-weight:bold;
        }

        .label.top {
          display:block;
        }

        .label.left {
          display:inline-block;
          float:left;
          padding-right:0.5em;
        }

        .label.right {
          display:inline-block;
          float:right;
          padding-left:0.5em;
        }

        .spacer {
          width:100%;
          height:3px;
          margin: 0.5em 0 1em 0;
          text-align:center;
          line-height:3px;

          &.below {
            td {
              height:0px;
              padding-bottom:1em;
            }
            &.rule td {
              height:1px;
              border-bottom:1px solid #808080;
              &:nth-of-type(2) {
                min-width:10em;
              }
            }
          }
        } /* .spacer */

        .vmiddle {
          vertical-align:middle;
        }

        .vmiddle * {
          vertical-align:middle;
        }

      } /* form#cafevdb-email-form */

    } /* div#emailformwrapper */

  }
}

/* special elements */

div#sendingprogresswrapper {
  display:none;
  width:60em;
  vertical-align:middle;

  .messagecount {
    width:100%;
    line-height:2em;
    vertical-align:middle;
    font-size:120%;
    font-weight:bold;
    margin-bottom:0.5em;
    text-align:center;
  }

  div.progress.#{$cssPrefix}row {
    width:100%;
    height:2em;
    padding: 0.5em;
    line-height:2em;
  }

  span.title {
    font-weight:bold;
    float:left;
    display:inline-block;
    width:10em;
    vertical-align:middle;
  }

  span.progressbar {
    float:right;
    display:inline-block;
    width:40em;
    margin-right:1em;
  }
}

.error.emailform span,
.error.emailform div {
  max-width:60em;
}

.emailform.error.group {
  padding-bottom:0.5em;
}

span.error.code,
span.error.contents.item.substitutions {
  color:red;
  font-family:monospace;
  font-weight:bold;
}

form#cafevdb-email-form {

  .missing-email-addresses {
    span.personal-record {
      color:red;
      font-style:italic;
      text-decoration:undline;
      font-weight:bold;
      cursor:pointer;
      padding:2px;
    }

    span.personal-record:hover {
      box-shadow:1px 1px 1px #080808; /*, 1px 1px 1px #cfc inset;*/
      /*background-color:LightSteelBlue;*/
      background-color:rgba(250,250,250,0.9);
    }

    span.personal-record:active {
      box-shadow:1px 1px 1px #080808 inset; /*, 1px 1px 1px #cfc inset;*/
      background-color:LightSteelBlue;
    }
  }

  .member-status-filter.#{$cssPrefix}container {
    min-height:2em;
    line-height:2em;
    width:100%;
  }

  #member_status_filter_chosen {
    min-width:40% !important;
    max-width:80% !important;
    width:auto !important;
  }

  .basic-recipients-set.#{$cssPrefix}container.inner {
    margin: 0 0.5em 0 0.5em;
    position:relative;
    max-width:35%;
  }

  input[type=checkbox].basic-recipients-set {
    position: absolute;
    left:-10000px;
    top: auto;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }
  span.basic-recipients-set.#{$cssPrefix}container.outer {
    max-width:100%;
    white-space:nowrap;
    overflow:hidden;
  }

  input[type=checkbox] + .label {
    width:100%;
  }

  input[type=checkbox] + .label span.button {
    display:inline-block;
    background-color:#F4F4F4 !important;
    box-shadow:1px 1px 1px #080808;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    max-width:100%;
  }

  input[type=checkbox]:checked + .label span.button {
    display:inline-block;
    background-color:LightSteelBlue !important;
    box-shadow:1px 1px 1px #080808 inset;
    white-space:nowrap;
    text-overflow:ellipsis;
  }

  .recipients-select.#{$cssPrefix}container {
    width:80%;
  }

  .instruments-filter.#{$cssPrefix}container {
    width:18%;
    text-align:right;
    cursor: pointer;
  }

  .instruments-filter.#{$cssPrefix}container label {
  }

  span#instruments-filter-wrapper {
    margin-top:0.3em;
    display:inline-block;
    text-align:left;
    width: 100%;
  }

  .instruments-filter.#{$cssPrefix}container .chosen-container {
    width:100% !important;
  }

  input.instruments-filter-controls {
    &.apply, &.undo, &.redo, &.reset {
      background-repeat:no-repeat;
      background-size: 28px 28px;
      background-position: center;
      width:28px;
      height:28px;
      font-size:0pt;
      vertical-align:middle;
    }
    &.apply { background-image:url('../img/email-new-yes.svg'); }
    &.undo { background-image:url('../img/email-new-undo.svg'); }
    &.redo { background-image:url('../img/email-new-redo.svg'); }
    &.reset { background-image:url('../img/email-new-x.svg'); }
  }
}

/******************************************************************************
 *
 * Hide message text in oc-dialog after sending, still visible in
 * status-tab, which really is enough
 *
 */
.oc-dialog .group.message.text {
  display:none;
  height:0;
  max-height:0;
}

/******************************************************************************
 *
 * File upload support
 *
 */

.file-upload-form {
  width:0;
  height:0;
}
.file-upload-target {
  display:none;
}
.file-upload-start {
  ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
  filter:alpha(opacity=0);
  opacity:0;
  z-index:1001;
  width:0;
  height:0;
}

/*****************************************************************************
 *
 * Preview in debug tab
 *
 */

div#cafevdb-email-preview {
  line-height:initial;
  font-size:initial;

  .email-header {
    color:red;
    font-weight:bold;
    margin-bottom:0.5em;
    margin-top:0.5em;
  }

  .reset-css {

    * {
      all:revert;
    }

    @import 'sanitize.css/sanitize';
    @import '@csstools/normalize.css/normalize';
    /*@import 'normalize.css/normalize';*/

    .flex-container {
      display:flex;
    }

    .email-body {
    }

    &.email-attachments {
      &.empty {
        display:none;
      }
      h4.centered-in-rule {
        font-weight:normal;
        display: flex;
        flex-direction: row;
        &:before, &:after{
          content: "";
          flex: 1 1;
          border-bottom: 1px solid;
          margin: auto;
        }
        &:before {
          margin-right: 1em;
          margin-left:0.5em;
        }
        &:after {
          margin-left: 1em;
          margin-right:0.5em;
        }
      }
      li .attachment-item {
        /* display:inline-block; */
        display:inline-flex;
        align-items:baseline;
        span {
          /* margin-right: 0.5em; */
          display:inline-block;

          &.filename {
            font-family:monospace;
          }
          &.mime-type {
            font-style:italic;
          }
          &.size {
          }
          &.separator {
            margin-left:0.5em;
            margin-right:0.5em;
          }
        }
      }
    }
  }

  hr.email-preview-separator  {
    border:1px solid black;
  }
}

/*
 * Local Variables: ***
 * css-indent-offset: 2 ***
 * End: ***
 */
