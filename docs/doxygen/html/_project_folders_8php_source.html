<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<link rel="shortcut icon" type="image/png" href="/nextcloud-git/apps/cafevdb/img/logo-greyf32x32.png" />
<title>CamerataDB: /var/www/dev1/htdocs/nextcloud-git-25/apps/cafevdb/lib/Command/ProjectFolders.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="/usr/share/mathjax/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo128x128.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CamerataDB
   &#160;<span id="projectnumber">3.0</span>
   </div>
   <div id="projectbrief">Database application to ease the management of a project-oriented orchestra.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_project_folders_8php_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">ProjectFolders.php</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span>&lt;?php</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command.html">OCA\CAFEVDB\Command</a>;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>use OCP\IL10N;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>use OCP\IUserSession;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>use OCP\IUserManager;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>use OCP\AppFramework\IAppContainer;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>use OCA\CAFEVDB\Wrapped\Doctrine\Common\Collections\Collection;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>use Symfony\Component\Console\Command\Command;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>use Symfony\Component\Console\Input\InputInterface;</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>use Symfony\Component\Console\Output\OutputInterface;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>use Symfony\Component\Console\Input\InputOption;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>use Symfony\Component\Console\Question\Question;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>use Symfony\Component\Console\Helper\ProgressBar;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>use Symfony\Component\Console\Helper\DescriptorHelper;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>use <a class="code hl_class" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_service_1_1_encryption_service.html">OCA\CAFEVDB\Service\EncryptionService</a>;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>use <a class="code hl_class" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_service_1_1_project_service.html">OCA\CAFEVDB\Service\ProjectService</a>;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>use <a class="code hl_class" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_entity_manager.html">OCA\CAFEVDB\Database\EntityManager</a>;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>use <a class="code hl_namespace" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_o_r_m_1_1_entities.html">OCA\CAFEVDB\Database\Doctrine\ORM\Entities</a>;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>use <a class="code hl_namespace" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_o_r_m_1_1_repositories.html">OCA\CAFEVDB\Database\Doctrine\ORM\Repositories</a>;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>use <a class="code hl_class" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_util.html">OCA\CAFEVDB\Database\Doctrine\Util</a> as DBUtil;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>use <a class="code hl_class" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_storage_1_1_user_storage.html">OCA\CAFEVDB\Storage\UserStorage</a>;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html">   51</a></span><span class="keyword">class </span><a class="code hl_class" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html">ProjectFolders</a> <span class="keyword">extends</span> Command</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>{</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  use <a class="code hl_variable" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command.html#a89ec67aace45e437927a213520eee149">AuthenticatedCommandTrait</a>;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html#aab47188b7085ed7d8ba7902e4503fbb4">   56</a></span>  <span class="keyword">public</span> <span class="keyword">function</span> <a class="code hl_function" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html#aab47188b7085ed7d8ba7902e4503fbb4">__construct</a>(</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="keywordtype">string</span> $appName,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    IL10N $l10n,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    IUserManager $userManager,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    IUserSession $userSession,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    IAppContainer $appContainer,</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  ) {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    parent::__construct();</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    $this-&gt;appName = $appName;</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    $this-&gt;l = $l10n;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    $this-&gt;userManager = $userManager;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    $this-&gt;userSession = $userSession;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    $this-&gt;appContainer = $appContainer;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>  }</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html#a9be5e0bdb5720efed6ddb6426c5c16ee">   72</a></span>  <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code hl_function" href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html#a9be5e0bdb5720efed6ddb6426c5c16ee">configure</a>()</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  {</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    $this</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>      -&gt;setName(<span class="stringliteral">&#39;cafevdb:projects:folders&#39;</span>)</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>      -&gt;setDescription(<span class="stringliteral">&#39;Ensure all or selected project-folders exist.&#39;</span>)</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>      -&gt;addOption(</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>        <span class="stringliteral">&#39;folder&#39;</span>,</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        <span class="charliteral">&#39;f&#39;</span>,</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>        InputOption::VALUE_REQUIRED,</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        <span class="stringliteral">&#39;Restrict the operation to the given (sub-)folder, specified by its configuration key &#39;</span> . implode(<span class="stringliteral">&#39;, &#39;</span>, ProjectService::PROJECT_FOLDER_CONFIG_KEYS),</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      )</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>      -&gt;addOption(</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        <span class="stringliteral">&#39;all&#39;</span>,</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        <span class="charliteral">&#39;a&#39;</span>,</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        InputOption::VALUE_NONE,</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        <span class="stringliteral">&#39;Work on all folders of all projects&#39;</span>,</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>      )</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>      -&gt;addOption(</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        <span class="stringliteral">&#39;project&#39;</span>,</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        <span class="charliteral">&#39;p&#39;</span>,</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        InputOption::VALUE_REQUIRED,</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="stringliteral">&#39;Restrict the operation to the given project. Can be combined with --folder=FOLDER&#39;</span>,</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>      )</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>      -&gt;addOption(</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        <span class="stringliteral">&#39;years&#39;</span>,</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        <span class="charliteral">&#39;y&#39;</span>,</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        InputOption::VALUE_REQUIRED,</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        <span class="stringliteral">&#39;Restrict the operation to projects of the given years. Single years and incomplete ranges are allowed. Can be combined with --folder=FOLDER&#39;</span>,</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>      )</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>      -&gt;addOption(</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>        <span class="stringliteral">&#39;dry&#39;</span>,</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>        <span class="keyword">null</span>,</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        InputOption::VALUE_NONE,</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        <span class="stringliteral">&#39;Just simulate, do not generate any folders.&#39;</span>,</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>      )</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>      -&gt;addOption(</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>        <span class="stringliteral">&#39;check&#39;</span>,</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        <span class="charliteral">&#39;c&#39;</span>,</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>        InputOption::VALUE_NONE,</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        <span class="stringliteral">&#39;Check if the folders exist, exit with non-zero status if any is missing, print warnings.&#39;</span>,</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>      )</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      -&gt;addOption(</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <span class="stringliteral">&#39;skeleton&#39;</span>,</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        <span class="charliteral">&#39;s&#39;</span>,</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        InputOption::VALUE_REQUIRED,</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        <span class="stringliteral">&#39;Modify the handling of the skeleton structure, if any has been provided. SKELETON is one of &quot;omit&quot;, &quot;overwrite&quot;, &quot;clean&quot;, in order to not copy any skeleton file, overwrite all existing files with the skeleton files or clean existing files which are not present in the skeleton structure. The default is to copy over the skeleton files but to not overwrite existing files with skeleton files.&#39;</span>,</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>      )</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>      ;</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>  }</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>  <span class="keyword">protected</span> <span class="keyword">function</span> execute(InputInterface $input, OutputInterface $output): int</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  {</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    $folder = $input-&gt;getOption(<span class="stringliteral">&#39;folder&#39;</span>);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    $projectName = $input-&gt;getOption(<span class="stringliteral">&#39;project&#39;</span>);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    $years = $input-&gt;getOption(<span class="stringliteral">&#39;years&#39;</span>);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    $all = $input-&gt;getOption(<span class="stringliteral">&#39;all&#39;</span>);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    $skel = $input-&gt;getOption(<span class="stringliteral">&#39;skeleton&#39;</span>);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    $dry = $input-&gt;getOption(<span class="stringliteral">&#39;dry&#39;</span>);</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    $check = $input-&gt;getOption(<span class="stringliteral">&#39;check&#39;</span>);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <span class="keywordflow">if</span> ($check) {</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>      $dry = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    }</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <span class="keywordflow">if</span> (empty($years) &amp;&amp; empty($folder) &amp;&amp; empty($projectName) &amp;&amp; empty($all)) {</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>      $output-&gt;writeln(<span class="stringliteral">&#39;&lt;error&gt;&#39;</span> . $this-&gt;l-&gt;t(<span class="stringliteral">&#39;One of the options &quot;years=RANGE&quot;, &quot;--folder=FOLDER&quot;, &quot;--project=PROJECT&quot; or &quot;--all&quot; has to be specified.&#39;</span>) . <span class="stringliteral">&#39;&lt;/error&gt;&#39;</span>);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>      $output-&gt;writeln(<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>      (<span class="keyword">new</span> DescriptorHelper)-&gt;describe($output, $this);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    }</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="keywordflow">if</span> (!empty($all) &amp;&amp; (!empty($folder) || !empty($projectName))) {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>      $output-&gt;writeln(<span class="stringliteral">&#39;&lt;error&gt;&#39;</span> . $this-&gt;l-&gt;t(<span class="stringliteral">&#39;&quot;--all&quot; cannot be compbined with &quot;years=RANGE&quot;, &quot;--folder=FOLDER&quot; or &quot;--project=PROJECT&quot;.&#39;</span>) . <span class="stringliteral">&#39;&lt;/error&gt;&#39;</span>);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>      $output-&gt;writeln(<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    }</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="keywordflow">if</span> (!empty($skel) &amp;&amp; !in_array($skel, [<span class="stringliteral">&#39;omit&#39;</span>, <span class="stringliteral">&#39;overwrite&#39;</span>, <span class="stringliteral">&#39;clean&#39;</span>])) {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>      $output-&gt;writeln(<span class="stringliteral">&#39;&lt;error&gt;&#39;</span> . $this-&gt;l-&gt;t(<span class="stringliteral">&#39;SKELETON must be one of &quot;omit&quot;, &quot;overwrite&quot; or &quot;clean&quot;.&#39;</span>));</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>      $output-&gt;writeln(<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    }</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="keywordflow">if</span> (!empty($folder) &amp;&amp; !in_array($folder, ProjectService::PROJECT_FOLDER_CONFIG_KEYS)) {</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>      $output-&gt;writeln(<span class="stringliteral">&#39;&lt;error&gt;&#39;</span> . $this-&gt;l-&gt;t(<span class="stringliteral">&#39;FOLDER must be one of &quot;%s&quot;&#39;</span>, implode(<span class="stringliteral">&#39;&quot;, &quot;&#39;</span>, ProjectService::PROJECT_FOLDER_CONFIG_KEYS)));</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>      $output-&gt;writeln(<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    }</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <span class="keywordflow">if</span> (empty($years)) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>      $firstYear = 1000;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>      $lastYear = 9999;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    } elseif (preg_match(<span class="stringliteral">&#39;/([0-9]{4})?\\s*-?\\s*([0-9]{4})?/&#39;</span>, $years, $matches)) {</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>      $output-&gt;writeln(<span class="stringliteral">&#39;YEARS &#39;</span> . print_r($matches, <span class="keyword">true</span>));</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>      $firstYear = $matches[1] ?? 1000;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>      $lastYear = $matches[2] ?? 9999;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    }</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    $result = $this-&gt;<a class="code hl_function" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command.html#a6082aee5cbe1682af193ef2a04b7eb17">authenticate</a>($input, $output);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    <span class="keywordflow">if</span> ($result != 0) {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>      <span class="keywordflow">return</span> $result;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    }</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    $this-&gt;<a class="code hl_function" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits.html#a76cac93e2db9f7f0050f62a9e986c427">disableFilter</a>(EntityManager::SOFT_DELETEABLE_FILTER);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    $projectService = $this-&gt;<a class="code hl_function" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits.html#a3a2983317152273aaf635e4bd61f0c7a">appContainer</a>-&gt;get(ProjectService::class);</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    $userStorage = $this-&gt;<a class="code hl_function" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits.html#a3a2983317152273aaf635e4bd61f0c7a">appContainer</a>-&gt;get(UserStorage::class);</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    $projectsRepository = $this-&gt;<a class="code hl_function" href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits.html#ab6f5f4edde190f5e5f1cd1e2fdd402d4">getDatabaseRepository</a>(Entities\Project::class);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    $totals = 0;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    $projectCriteria = [</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>      <span class="stringliteral">&#39;&gt;=year&#39;</span> =&gt; $firstYear,</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      <span class="stringliteral">&#39;&lt;=year&#39;</span> =&gt; $lastYear,</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    ];</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keywordflow">if</span> (!empty($projectName)) {</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>      $projectCriteria[<span class="stringliteral">&#39;name&#39;</span>] = $projectName;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    }</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    $output-&gt;writeln(<span class="stringliteral">&#39;PROJECT CRIT &#39;</span> . print_r($projectCriteria, <span class="keyword">true</span>));</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    $projects = $projectsRepository-&gt;findBy($projectCriteria, [ <span class="stringliteral">&#39;year&#39;</span> =&gt; <span class="stringliteral">&#39;DESC&#39;</span>, <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;ASC&#39;</span> ]);</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="keywordflow">foreach</span> ($projects as $project) {</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>      $folders = $projectService-&gt;ensureProjectFolders($project, $folder, $dry);</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>      $output-&gt;writeln(<span class="stringliteral">&#39;PROJECT &#39;</span> . $project-&gt;getName() . <span class="stringliteral">&#39;: &#39;</span> . implode(<span class="stringliteral">&#39;, &#39;</span>, $folders));</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>  }</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>}</div>
<div class="ttc" id="aclass_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders_html"><div class="ttname"><a href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html">OCA\CAFEVDB\Command\ProjectFolders</a></div><div class="ttdoc">Create all participant sub-folder for each project.</div><div class="ttdef"><b>Definition:</b> <a href="_project_folders_8php_source.html#l00051">ProjectFolders.php:52</a></div></div>
<div class="ttc" id="aclass_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders_html_a9be5e0bdb5720efed6ddb6426c5c16ee"><div class="ttname"><a href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html#a9be5e0bdb5720efed6ddb6426c5c16ee">OCA\CAFEVDB\Command\ProjectFolders\configure</a></div><div class="ttdeci">configure()</div><div class="ttdoc">{}</div><div class="ttdef"><b>Definition:</b> <a href="_project_folders_8php_source.html#l00072">ProjectFolders.php:72</a></div></div>
<div class="ttc" id="aclass_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders_html_aab47188b7085ed7d8ba7902e4503fbb4"><div class="ttname"><a href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_1_1_project_folders.html#aab47188b7085ed7d8ba7902e4503fbb4">OCA\CAFEVDB\Command\ProjectFolders\__construct</a></div><div class="ttdeci">__construct(string $appName, IL10N $l10n, IUserManager $userManager, IUserSession $userSession, IAppContainer $appContainer,)</div><div class="ttdoc">{}</div><div class="ttdef"><b>Definition:</b> <a href="_project_folders_8php_source.html#l00056">ProjectFolders.php:56</a></div></div>
<div class="ttc" id="aclass_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_util_html"><div class="ttname"><a href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_util.html">OCA\CAFEVDB\Database\Doctrine\Util</a></div><div class="ttdoc">Some mostly static convenience stuff.</div><div class="ttdef"><b>Definition:</b> <a href="_database_2_doctrine_2_util_8php_source.html#l00032">Util.php:33</a></div></div>
<div class="ttc" id="aclass_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_entity_manager_html"><div class="ttname"><a href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_entity_manager.html">OCA\CAFEVDB\Database\EntityManager</a></div><div class="ttdoc">Use this as the actual EntityManager in order to be able to construct it without a Factory and to def...</div><div class="ttdef"><b>Definition:</b> <a href="_entity_manager_8php_source.html#l00098">EntityManager.php:99</a></div></div>
<div class="ttc" id="aclass_o_c_a_1_1_c_a_f_e_v_d_b_1_1_service_1_1_encryption_service_html"><div class="ttname"><a href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_service_1_1_encryption_service.html">OCA\CAFEVDB\Service\EncryptionService</a></div><div class="ttdoc">Handle some encryption tasks:</div><div class="ttdef"><b>Definition:</b> <a href="_encryption_service_8php_source.html#l00075">EncryptionService.php:76</a></div></div>
<div class="ttc" id="aclass_o_c_a_1_1_c_a_f_e_v_d_b_1_1_service_1_1_project_service_html"><div class="ttname"><a href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_service_1_1_project_service.html">OCA\CAFEVDB\Service\ProjectService</a></div><div class="ttdoc">General support service, kind of inconsequent glue between Doctrine\ORM and CAFEVDB\PageRenderer.</div><div class="ttdef"><b>Definition:</b> <a href="_project_service_8php_source.html#l00060">ProjectService.php:61</a></div></div>
<div class="ttc" id="aclass_o_c_a_1_1_c_a_f_e_v_d_b_1_1_storage_1_1_user_storage_html"><div class="ttname"><a href="class_o_c_a_1_1_c_a_f_e_v_d_b_1_1_storage_1_1_user_storage.html">OCA\CAFEVDB\Storage\UserStorage</a></div><div class="ttdoc">Some tweaks to for the user-folder stuff.</div><div class="ttdef"><b>Definition:</b> <a href="_user_storage_8php_source.html#l00059">UserStorage.php:60</a></div></div>
<div class="ttc" id="anamespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_html"><div class="ttname"><a href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command.html">OCA\CAFEVDB\Command</a></div><div class="ttdoc">Orchestra member, musician and project management application.</div><div class="ttdef"><b>Definition:</b> <a href="_authenticated_command_trait_8php_source.html#l00025">AuthenticatedCommandTrait.php:25</a></div></div>
<div class="ttc" id="anamespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_html_a6082aee5cbe1682af193ef2a04b7eb17"><div class="ttname"><a href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command.html#a6082aee5cbe1682af193ef2a04b7eb17">OCA\CAFEVDB\Command\authenticate</a></div><div class="ttdeci">authenticate(InputInterface $input, OutputInterface $output)</div><div class="ttdoc">{}</div><div class="ttdef"><b>Definition:</b> <a href="_authenticated_command_trait_8php_source.html#l00074">AuthenticatedCommandTrait.php:74</a></div></div>
<div class="ttc" id="anamespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command_html_a89ec67aace45e437927a213520eee149"><div class="ttname"><a href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_command.html#a89ec67aace45e437927a213520eee149">OCA\CAFEVDB\Command\AuthenticatedCommandTrait</a></div><div class="ttdeci">trait AuthenticatedCommandTrait</div><div class="ttdoc">Trait in order to handle authentication with the cloud.</div><div class="ttdef"><b>Definition:</b> <a href="_authenticated_command_trait_8php_source.html#l00046">AuthenticatedCommandTrait.php:47</a></div></div>
<div class="ttc" id="anamespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_o_r_m_1_1_entities_html"><div class="ttname"><a href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_o_r_m_1_1_entities.html">OCA\CAFEVDB\Database\Doctrine\ORM\Entities</a></div><div class="ttdoc">Orchestra member, musician and project management application.</div><div class="ttdef"><b>Definition:</b> <a href="_change_log_8php_source.html#l00025">ChangeLog.php:25</a></div></div>
<div class="ttc" id="anamespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_o_r_m_1_1_repositories_html"><div class="ttname"><a href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_database_1_1_doctrine_1_1_o_r_m_1_1_repositories.html">OCA\CAFEVDB\Database\Doctrine\ORM\Repositories</a></div><div class="ttdoc">Orchestra member, musician and project management application.</div><div class="ttdef"><b>Definition:</b> <a href="_composite_payments_repository_8php_source.html#l00025">CompositePaymentsRepository.php:25</a></div></div>
<div class="ttc" id="anamespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits_html_a3a2983317152273aaf635e4bd61f0c7a"><div class="ttname"><a href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits.html#a3a2983317152273aaf635e4bd61f0c7a">OCA\CAFEVDB\Traits\appContainer</a></div><div class="ttdeci">appContainer()</div><div class="ttdef"><b>Definition:</b> <a href="_config_trait_8php_source.html#l00110">ConfigTrait.php:110</a></div></div>
<div class="ttc" id="anamespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits_html_a76cac93e2db9f7f0050f62a9e986c427"><div class="ttname"><a href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits.html#a76cac93e2db9f7f0050f62a9e986c427">OCA\CAFEVDB\Traits\disableFilter</a></div><div class="ttdeci">disableFilter(string $filterName)</div><div class="ttdoc">Disable the given filter.</div><div class="ttdef"><b>Definition:</b> <a href="_entity_manager_trait_8php_source.html#l00363">EntityManagerTrait.php:363</a></div></div>
<div class="ttc" id="anamespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits_html_ab6f5f4edde190f5e5f1cd1e2fdd402d4"><div class="ttname"><a href="namespace_o_c_a_1_1_c_a_f_e_v_d_b_1_1_traits.html#ab6f5f4edde190f5e5f1cd1e2fdd402d4">OCA\CAFEVDB\Traits\getDatabaseRepository</a></div><div class="ttdeci">getDatabaseRepository($entityClassName=null)</div><div class="ttdoc">Set and get the given name as the current database target entity.</div><div class="ttdef"><b>Definition:</b> <a href="_entity_manager_trait_8php_source.html#l00081">EntityManagerTrait.php:81</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_0ff164efcd794d03b196bcf3d2ed306b.html">Command</a></li><li class="navelem"><b>ProjectFolders.php</b></li>
    <li class="footer">Generated on Mon Mar 20 2023 09:14:37 for CamerataDB by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
