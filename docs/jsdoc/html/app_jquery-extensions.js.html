<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>app/jquery-extensions.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#actionHandler">actionHandler</a></li><li><a href="global.html#addEditor">addEditor</a></li><li><a href="global.html#addMusicians">addMusicians</a></li><li><a href="global.html#addReadyCallback">addReadyCallback</a></li><li><a href="global.html#afterLoad">afterLoad</a></li><li><a href="global.html#ajaxFailData">ajaxFailData</a></li><li><a href="global.html#ajaxFailMessage">ajaxFailMessage</a></li><li><a href="global.html#ajaxHandleError">ajaxHandleError</a></li><li><a href="global.html#ajaxValidateResponse">ajaxValidateResponse</a></li><li><a href="global.html#appInfo">appInfo</a></li><li><a href="global.html#applyToolTips">applyToolTips</a></li><li><a href="global.html#appPrefix">appPrefix</a></li><li><a href="global.html#appSettings">appSettings</a></li><li><a href="global.html#attachHandlers">attachHandlers</a></li><li><a href="global.html#checkInvalidInputs">checkInvalidInputs</a></li><li><a href="global.html#chosenActive">chosenActive</a></li><li><a href="global.html#clearObject">clearObject</a></li><li><a href="global.html#closeActionMenu">closeActionMenu</a></li><li><a href="global.html#contactValidation">contactValidation</a></li><li><a href="global.html#containerSelector">containerSelector</a></li><li><a href="global.html#createProgressStatus">createProgressStatus</a></li><li><a href="global.html#debugPopup">debugPopup</a></li><li><a href="global.html#dialogCustomCloseButton">dialogCustomCloseButton</a></li><li><a href="global.html#dialogFullScreenButton">dialogFullScreenButton</a></li><li><a href="global.html#dialogToBackButton">dialogToBackButton</a></li><li><a href="global.html#documentReady">documentReady</a></li><li><a href="global.html#download">download</a></li><li><a href="global.html#emailFormCompositionHandlers">emailFormCompositionHandlers</a></li><li><a href="global.html#emailFormPopup">emailFormPopup</a></li><li><a href="global.html#emailFormRecipientsHandlers">emailFormRecipientsHandlers</a></li><li><a href="global.html#emailFormRecipientsSelectControls">emailFormRecipientsSelectControls</a></li><li><a href="global.html#emailPopup">emailPopup</a></li><li><a href="global.html#ensureDropdownVisibility">ensureDropdownVisibility</a></li><li><a href="global.html#eventsPopup">eventsPopup</a></li><li><a href="global.html#findOptionByValue">findOptionByValue</a></li><li><a href="global.html#FindRanges">FindRanges</a></li><li><a href="global.html#formSubmit">formSubmit</a></li><li><a href="global.html#generateSettingsUrl">generateSettingsUrl</a></li><li><a href="global.html#generateUrl">generateUrl</a></li><li><a href="global.html#getAppUrl">getAppUrl</a></li><li><a href="global.html#getChildren">getChildren</a></li><li><a href="global.html#getControlObject">getControlObject</a></li><li><a href="global.html#getOptions">getOptions</a></li><li><a href="global.html#getOptionValues">getOptionValues</a></li><li><a href="global.html#getPersonalUrl">getPersonalUrl</a></li><li><a href="global.html#getSelectize">getSelectize</a></li><li><a href="global.html#getToken">getToken</a></li><li><a href="global.html#getUrl">getUrl</a></li><li><a href="global.html#getWidget">getWidget</a></li><li><a href="global.html#handleProjectActions">handleProjectActions</a></li><li><a href="global.html#handleQueryLogMenu">handleQueryLogMenu</a></li><li><a href="global.html#handleTableExportMenu">handleTableExportMenu</a></li><li><a href="global.html#htmlDecode">htmlDecode</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#installInputSelectize">installInputSelectize</a></li><li><a href="global.html#instrumentationNumbersPopup">instrumentationNumbersPopup</a></li><li><a href="global.html#invalidInputDowncount">invalidInputDowncount</a></li><li><a href="global.html#isVanilla">isVanilla</a></li><li><a href="global.html#jQuery">jQuery</a></li><li><a href="global.html#lazyBatchDecryptValues">lazyBatchDecryptValues</a></li><li><a href="global.html#loadPage">loadPage</a></li><li><a href="global.html#loadPMETable">loadPMETable</a></li><li><a href="global.html#loadPMETableFiltered">loadPMETableFiltered</a></li><li><a href="global.html#mandatesInit">mandatesInit</a></li><li><a href="global.html#mandateValidate">mandateValidate</a></li><li><a href="global.html#mandateValidatePME">mandateValidatePME</a></li><li><a href="global.html#mandateValidatePMEPromise">mandateValidatePMEPromise</a></li><li><a href="global.html#mandateValidatePMEWorker">mandateValidatePMEWorker</a></li><li><a href="global.html#maybeTranspose">maybeTranspose</a></li><li><a href="global.html#messages">messages</a></li><li><a href="global.html#modalizer">modalizer</a></li><li><a href="global.html#modalWaitNotification">modalWaitNotification</a></li><li><a href="global.html#myLoadAddMusicians">myLoadAddMusicians</a></li><li><a href="global.html#myLoadMusicians">myLoadMusicians</a></li><li><a href="global.html#myLoadProjectParticipants">myLoadProjectParticipants</a></li><li><a href="global.html#myPersonalRecordDialog">myPersonalRecordDialog</a></li><li><a href="global.html#nonTextInputTypes">nonTextInputTypes</a></li><li><a href="global.html#participantFieldsPopup">participantFieldsPopup</a></li><li><a href="global.html#photoEditCurrent">photoEditCurrent</a></li><li><a href="global.html#photoLoad">photoLoad</a></li><li><a href="global.html#photoLoadHandlers">photoLoadHandlers</a></li><li><a href="global.html#photoReady">photoReady</a></li><li><a href="global.html#photoUploadDragDrop">photoUploadDragDrop</a></li><li><a href="global.html#pmeCellSelector">pmeCellSelector</a></li><li><a href="global.html#pmeClassSelector">pmeClassSelector</a></li><li><a href="global.html#pmeClassSelectors">pmeClassSelectors</a></li><li><a href="global.html#pmeContainer">pmeContainer</a></li><li><a href="global.html#pmeContextMenu">pmeContextMenu</a></li><li><a href="global.html#pmeData">pmeData</a></li><li><a href="global.html#pmeDeferReload">pmeDeferReload</a></li><li><a href="global.html#pmeFilterSelector">pmeFilterSelector</a></li><li><a href="global.html#pmeFormSelector">pmeFormSelector</a></li><li><a href="global.html#pmeIdSelector">pmeIdSelector</a></li><li><a href="global.html#pmeInit">pmeInit</a></li><li><a href="global.html#pmeInner">pmeInner</a></li><li><a href="global.html#pmeInputSelector">pmeInputSelector</a></li><li><a href="global.html#pmeKeySelector">pmeKeySelector</a></li><li><a href="global.html#pmeNavigationSelector">pmeNavigationSelector</a></li><li><a href="global.html#pmeOpenRowDialog">pmeOpenRowDialog</a></li><li><a href="global.html#pmeQueryInfoSelector">pmeQueryInfoSelector</a></li><li><a href="global.html#pmeRec">pmeRec</a></li><li><a href="global.html#pmeRecordValue">pmeRecordValue</a></li><li><a href="global.html#pmeSelector">pmeSelector</a></li><li><a href="global.html#pmeSubmitOuterForm">pmeSubmitOuterForm</a></li><li><a href="global.html#pmeSys">pmeSys</a></li><li><a href="global.html#pmeSysNameSelector">pmeSysNameSelector</a></li><li><a href="global.html#pmeSysNameSelectors">pmeSysNameSelectors</a></li><li><a href="global.html#pmeTableDialogOpen">pmeTableDialogOpen</a></li><li><a href="global.html#pmeTableSelector">pmeTableSelector</a></li><li><a href="global.html#pmeToken">pmeToken</a></li><li><a href="global.html#pmeTriggerSubmit">pmeTriggerSubmit</a></li><li><a href="global.html#pmeTweaks">pmeTweaks</a></li><li><a href="global.html#pmeUnTweak">pmeUnTweak</a></li><li><a href="global.html#pmeValueSelector">pmeValueSelector</a></li><li><a href="global.html#pollProgressStatus">pollProgressStatus</a></li><li><a href="global.html#print_r">print_r</a></li><li><a href="global.html#projectPaymentPopup">projectPaymentPopup</a></li><li><a href="global.html#projectViewPopup">projectViewPopup</a></li><li><a href="global.html#projectWebPageRequest">projectWebPageRequest</a></li><li><a href="global.html#projectWebPageTabHandler">projectWebPageTabHandler</a></li><li><a href="global.html#pseudoSubmit">pseudoSubmit</a></li><li><a href="global.html#pseudoSubmitPost">pseudoSubmitPost</a></li><li><a href="global.html#queryData">queryData</a></li><li><a href="global.html#refreshSelectWidget">refreshSelectWidget</a></li><li><a href="global.html#refreshWidgetProperties">refreshWidgetProperties</a></li><li><a href="global.html#removeEditor">removeEditor</a></li><li><a href="global.html#renderTag">renderTag</a></li><li><a href="global.html#replaceSelectOptions">replaceSelectOptions</a></li><li><a href="global.html#resetDropdownVisibility">resetDropdownVisibility</a></li><li><a href="global.html#runReadyCallbacks">runReadyCallbacks</a></li><li><a href="global.html#selectedOptions">selectedOptions</a></li><li><a href="global.html#selectedValues">selectedValues</a></li><li><a href="global.html#selectizeActive">selectizeActive</a></li><li><a href="global.html#setAppUrl">setAppUrl</a></li><li><a href="global.html#setPersonalUrl">setPersonalUrl</a></li><li><a href="global.html#setToken">setToken</a></li><li><a href="global.html#simpleSetHandler">simpleSetHandler</a></li><li><a href="global.html#simpleSetValueHandler">simpleSetValueHandler</a></li><li><a href="global.html#snapshotEditor">snapshotEditor</a></li><li><a href="global.html#stopEnterSubmit">stopEnterSubmit</a></li><li><a href="global.html#tableDialog">tableDialog</a></li><li><a href="global.html#tableDialogHandlers">tableDialogHandlers</a></li><li><a href="global.html#tableDialogReload">tableDialogReload</a></li><li><a href="global.html#tableDialogReplace">tableDialogReplace</a></li><li><a href="global.html#Template">Template</a></li><li><a href="global.html#textareaResize">textareaResize</a></li><li><a href="global.html#toolTipsEnabled">toolTipsEnabled</a></li><li><a href="global.html#toolTipsInit">toolTipsInit</a></li><li><a href="global.html#transposeMainTable">transposeMainTable</a></li><li><a href="global.html#transposeReady">transposeReady</a></li><li><a href="global.html#unfocus">unfocus</a></li><li><a href="global.html#updateEditor">updateEditor</a></li><li><a href="global.html#urlDecode">urlDecode</a></li><li><a href="global.html#urlEncode">urlEncode</a></li><li><a href="global.html#validateInstrumentChoices">validateInstrumentChoices</a></li><li><a href="global.html#wikiPopup">wikiPopup</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">app/jquery-extensions.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Orchestra member, musicion and project management application.
 *
 * CAFEVDB -- Camerata Academica Freiburg e.V. DataBase.
 *
 * @author Claus-Justus Heine
 * @copyright 2011-2016, 2020, 2021, 2022 Claus-Justus Heine &lt;himself@claus-justus-heine.de>
 * @license AGPL-3.0-or-later
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see &lt;http://www.gnu.org/licenses/>.
 */
/**
 * @file
 *
 * Collect some jQuery tweaks in this file.
 *
 */

import $ from './jquery.js';
import * as CAFEVDB from './cafevdb.js';
import './jquery-cafevdb-tooltips.js';

require('jquery-ui/ui/widgets/dialog');
require('jquery-ui/ui/widgets/resizable');

console.log('jquery-extensions');

/**
 * We leave it to the z-index-plane to disallow interaction. Every
 * input element above any modal dialog is allowed to interact with
 * the user.
 */
$.widget('ui.dialog', $.ui.dialog, {
  _allowInteraction(event) {
    return true;
  },
});

/**
 * Special dialog version which attaches the dialog to the
 * #content-wrapper div.
 *
 * @param {object} argument TBD.
 *
 * @returns {object}
 */
$.fn.cafevDialog = function(argument) {
  if (arguments.length === 1 &amp;&amp; typeof argument === 'object' &amp;&amp; argument !== null) {
    const options = {
      appendTo: '#cafevdb-general',
      // appendTop: 'body',
    };
    argument = $.extend({}, options, argument);
    if (argument.dialogClass) {
      argument.dialogClass += ' cafev cafevdb';
    } else {
      argument.dialogClass = 'cafev cafevdb';
    }
    if ($('#appsettings_popup').length === 0) {
      CAFEVDB.snapperClose();
    }
    console.debug('will open dialog');
    $.fn.dialog.call(this, argument);
    if (this.dialog('option', 'draggable')) {
      console.debug('Try to set containment');
      $.fn.dialog.call(this, 'widget').draggable('option', 'containment', '#app-content');
    }
  } else {
    return $.fn.dialog.apply(this, arguments);
  }
  return this;
};

// $.extend($.ui.dialog.prototype.options, {
//   appendTo: '#content',
//   containment: '#content'
// });

/**
 * Determine whether scrollbars would be needed.
 *
 * @returns {object}
 */
$.fn.needScrollbars = function() {
  const node = this.get(0);
  return {
    vertical: node.scrollHeight > node.offsetHeight,
    horizontal: node.scrollWidth > node.offsetWidth,
  };
};

/**
 * Determine whether scrollbars are actually present.
 *
 * We have here the problem that
 *
 * - node.boundingClientRect() does not return the scrollHeight/Width
 * - scrollHeight/Width is rounded
 * - clientHeight/Width is rounded
 *
 * Hence the +1 is an ugly tweak which seems to work a little bit.
 *
 * @returns {object}
 *
 */
$.fn.hasScrollbars = function() {
  const node = this.get(0);
  return {
    vertical: node.scrollHeight > node.clientHeight + 1,
    horizontal: node.scrollWidth > node.clientWidth + 1,
  };
};

/**
 * Determine dimensions of scrollbars.
 *
 * @returns {object}
 */
$.fn.scrollbarDimensions = function() {
  const node = this.get(0);
  return {
    height: node.offsetHeight - node.clientHeight + 1,
    width: node.offsetWidth - node.clientWidth + 1,
  };
};

/**
 * Determine whether we have a horizontal scrollbar.
 *
 * @returns {boolean}
 */
$.fn.hasHorizontalScrollbar = function() {
  const node = this.get(0);
  return node.scrollWidth > node.clientWidth + 1;
};

/**
 * Determine whether we have a vertical scrollbar.
 *
 * @returns {boolean}
 */
$.fn.hasVerticalScrollbar = function() {
  const node = this.get(0);
  return node.scrollHeight > node.clientHeight + 1;
};

/**
 * Determine vertical scrollbar width.
 *
 * @returns {number}
 */
$.fn.verticalScrollbarWidth = function() {
  const node = this.get(0);
  return node.offsetWidth - node.clientWidth;
};

/**
 * Determine horizontal scrollbar height.
 *
 * @returns {number}
 */
$.fn.horizontalScrollbarHeight = function() {
  const node = this.get(0);
  return node.offsetHeight - node.clientHeight;
};

$.extend({
  alert(message, title) {
    $('&lt;div>&lt;/div>').dialog({
      buttons: { Ok() { $(this).dialog('close'); } },
      open(event, ui) {
        $(this).css({ 'max-height': 800, 'overflow-y': 'auto', height: 'auto' });
        $(this).dialog('option', 'resizable', false);
      },
      close(event, ui) { $(this).remove(); },
      resizable: false,
      title,
      modal: true,
      height: 'auto',
    }).html(message);
  },
});

/**
 * Compute the maximum width of a set of elements
 *
 * @returns {number}
 */
$.fn.maxWidth = function() {
  return Math.max.apply(null, this.map(function() {
    return $(this).width();
  }).get());
};

/**
 * Compute the maximum width of a set of elements
 *
 * @param {object} extended Blah.
 *
 * @returns {number}
 */
$.fn.maxOuterWidth = function(extended) {
  return Math.max.apply(null, this.map(function() {
    return $(this).outerWidth(extended);
  }).get());
};

/**
 * Compute the maximum height of a set of elements
 *
 * @returns {number}
 */
$.fn.maxHeight = function() {
  return Math.max.apply(null, this.map(function() {
    return $(this).height();
  }).get());
};

/**
 * Compute the maximum height of a set of elements
 *
 * @param {object} extended Blah.
 *
 * @returns {number}
 */
$.fn.maxOuterHeight = function(extended) {
  return Math.max.apply(null, this.map(function() {
    return $(this).outerHeight(extended);
  }).get());
};

/**
 * jQuery pixel/em conversion plugins: toEm() and toPx()
 * by Scott Jehl (scott@filamentgroup.com), http://www.filamentgroup.com
 * Copyright (c) Filament Group
 *
 * Dual licensed under the MIT
 * (filamentgroup.com/examples/mit-license.txt) or GPL
 * (filamentgroup.com/examples/gpl-license.txt) licenses.  Article:
 * http://www.filamentgroup.com/lab/update_jquery_plugin_for_retaining_scalable_interfaces_with_pixel_to_em_con/
 *
 * Options:
 *   scope: string or jQuery selector for font-size scoping
 * Usage Example: $(myPixelValue).toEm(); or $(myEmValue).toPx();
 *
 * @param {object} settings TBD.
 *
 * @returns {number}
 */
$.fn.toEm = function(settings) {
  settings = $.extend({
    scope: 'body',
  }, settings);
  const that = parseInt(this[0], 10);
  const scopeTest = $('&lt;div style="display: none; font-size: 1em; margin: 0; padding:0; height: auto; line-height: 1; border:0;">&amp;nbsp;&lt;/div>').appendTo(settings.scope);
  const scopeVal = scopeTest.height();
  scopeTest.remove();
  return (that / scopeVal).toFixed(8) + 'em';
};

$.fn.toPx = function(settings) {
  settings = $.extend({
    scope: 'body',
  }, settings);
  const that = parseFloat(this[0]);
  const scopeTest = $('&lt;div style="display: none; font-size: 1em; margin: 0; padding:0; height: auto; line-height: 1; border:0;">&amp;nbsp;&lt;/div>').appendTo(settings.scope);
  const scopeVal = scopeTest.height();
  scopeTest.remove();
  return Math.round(that * scopeVal) + 'px';
};

// Local Variables: ***
// indent-tabs-mode: nil ***
// js-indent-level: 2 ***
// End: ***
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Thu Apr 27 2023 09:11:07 GMT+0200 (Mitteleuropäische Sommerzeit) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
